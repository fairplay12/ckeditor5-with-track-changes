/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x32bd=['activeView','cancel','resize','left','detach','getIndex','delete','element','get','isActive','addEventListener','remove','Annotations','removeEventListener','destroy','customView','attach','function','change:isFocused','has','set','init','top','max','register','getTarget','getAnnotationView','pluginName','switchTo','targetRect','annotations-register-invalid-interface:\x20UI\x20plugin\x20must\x20implement\x20#attach\x20and\x20#detach\x20methods.','items','change:activeView','fire','annotations-switchto-missing-ui:\x20UI\x20of\x20a\x20given\x20name\x20has\x20been\x20not\x20registered.','locale','_throttledOrderUpdate','add','annotations-duplicated-item:\x20Given\x20view\x20was\x20already\x20added\x20to\x20the\x20annotations\x20repository.','focusTracker','uiType','selectedViews','from'];(function(_0xdeeccc,_0x32bddd){const _0x4571a7=function(_0x222e8a){while(--_0x222e8a){_0xdeeccc['push'](_0xdeeccc['shift']());}};_0x4571a7(++_0x32bddd);}(_0x32bd,0x9e));const _0x4571=function(_0xdeeccc,_0x32bddd){_0xdeeccc=_0xdeeccc-0x0;let _0x4571a7=_0x32bd[_0xdeeccc];return _0x4571a7;};import _0x4f47d9 from'@ckeditor/ckeditor5-core/src/contextplugin';import _0x1b2b97 from'../annotations/view/annotationview';import _0x19bb45 from'@ckeditor/ckeditor5-utils/src/collection';import _0x197564 from'@ckeditor/ckeditor5-utils/src/focustracker';import _0x505dc8 from'@ckeditor/ckeditor5-utils/src/dom/rect';import _0x1079be from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import{throttle as _0x31bdd1}from'lodash-es';import'../../theme/annotation.css';export default class a extends _0x4f47d9{static get[_0x4571('0x29')](){return _0x4571('0x1a');}constructor(_0xbfafab){super(_0xbfafab),this['items']=new _0x19bb45(),this[_0x4571('0x22')](_0x4571('0xc'),[]),this[_0x4571('0x22')](_0x4571('0xe'),null),this['on'](_0x4571('0x3'),(_0x53b59c,_0x1ccd92,_0x55b5ad,_0xc975fb)=>{_0x55b5ad&&(this['i']['get'](_0x55b5ad)[_0x4571('0x17')]=!0x0);const _0x3250c9=this['i'][_0x4571('0x16')](_0xc975fb);_0xc975fb&&_0x3250c9&&(_0x3250c9[_0x4571('0x17')]=!0x1);}),this[_0x4571('0xa')]=new _0x197564(),this[_0x4571('0xa')]['on'](_0x4571('0x20'),(_0x50af53,_0x3b1181,_0x4876d0)=>{_0x4876d0||(this[_0x4571('0xe')]=null);}),this[_0x4571('0xb')]='',this['s']=new Map(),this['i']=new Map(),this['o']=new Map(),this[_0x4571('0x7')]=_0x31bdd1(()=>{this['h'](),this['u']();},0x190,{'leading':!0x1});}[_0x4571('0x23')](){window[_0x4571('0x18')](_0x4571('0x10'),this[_0x4571('0x7')]);}[_0x4571('0x26')](_0x1ef87f,_0x5916fd){if(this['s'][_0x4571('0x21')](_0x1ef87f))throw new _0x1079be('annotations-register-already-registered:\x20UI\x20of\x20a\x20given\x20name\x20already\x20registered.');if(_0x4571('0x1f')!=typeof _0x5916fd[_0x4571('0x1e')]||_0x4571('0x1f')!=typeof _0x5916fd[_0x4571('0x12')])throw new _0x1079be(_0x4571('0x1'));this['s'][_0x4571('0x22')](_0x1ef87f,_0x5916fd);}[_0x4571('0x2a')](_0x2bf2b3){if(!this['s'][_0x4571('0x21')](_0x2bf2b3))throw new _0x1079be(_0x4571('0x5'),this);this[_0x4571('0xb')]!==_0x2bf2b3&&(this[_0x4571('0xb')]&&this['s'][_0x4571('0x16')](this[_0x4571('0xb')])['detach'](),this[_0x4571('0xb')]=_0x2bf2b3,this['s']['get'](this[_0x4571('0xb')])[_0x4571('0x1e')]());}[_0x4571('0x8')](_0x3058df,_0x44b4c2){if(this['i'][_0x4571('0x21')](_0x3058df))throw new _0x1079be(_0x4571('0x9'),this);const _0x1904fa=new _0x1b2b97(this['context'][_0x4571('0x6')],_0x3058df);_0x1904fa['render'](),this[_0x4571('0xa')]['add'](_0x1904fa['element']),_0x1904fa[_0x4571('0xa')]['on'](_0x4571('0x20'),(_0x8c0c90,_0x4b12df,_0x40dcf4)=>{_0x40dcf4&&(this[_0x4571('0xe')]=_0x3058df);}),this['o'][_0x4571('0x22')](_0x3058df,_0x44b4c2),this['l'](_0x1904fa);const _0x28c116=this['m'](_0x1904fa[_0x4571('0x0')]);return this[_0x4571('0x2')]['add'](_0x1904fa,_0x28c116),this['i']['set'](_0x3058df,_0x1904fa),_0x1904fa;}[_0x4571('0x19')](_0x3819dd){if(!this['i'][_0x4571('0x21')](_0x3819dd))return;const _0x5b28da=this['i'][_0x4571('0x16')](_0x3819dd);this[_0x4571('0xa')][_0x4571('0x19')](_0x5b28da[_0x4571('0x15')]),this[_0x4571('0xe')]===_0x3819dd&&(this[_0x4571('0xe')]=null),this[_0x4571('0x2')][_0x4571('0x19')](_0x5b28da),_0x5b28da[_0x4571('0x1c')](),this['o'][_0x4571('0x14')](_0x3819dd),this['i'][_0x4571('0x14')](_0x3819dd);}[_0x4571('0x27')](_0x339a9f){const _0x51991e=this['o'][_0x4571('0x16')](_0x339a9f);return _0x4571('0x1f')==typeof _0x51991e?_0x51991e():_0x51991e;}[_0x4571('0x28')](_0x141d1c){return this['i'][_0x4571('0x16')](_0x141d1c);}['refresh'](){this[_0x4571('0x4')]('refresh'),this[_0x4571('0x7')]();}[_0x4571('0x1c')](){super[_0x4571('0x1c')](),window[_0x4571('0x1b')]('resize',this[_0x4571('0x7')]),this[_0x4571('0x7')][_0x4571('0xf')](),this[_0x4571('0x2')]['map'](_0x2a597d=>_0x2a597d[_0x4571('0x1c')]());}['h'](){for(const _0x4c3a1a of this['items'])this['l'](_0x4c3a1a);}['l'](_0x389c08){const _0xe3f67b=this[_0x4571('0x27')](_0x389c08['customView']);_0x389c08['targetRect']=new _0x505dc8(_0xe3f67b);}['u'](){const _0x3dc214=Array[_0x4571('0xd')](this[_0x4571('0x2')])['sort']((_0x59d7e1,_0x472ea9)=>c(_0x59d7e1[_0x4571('0x0')],_0x472ea9['targetRect']));for(let _0x2ee155=_0x3dc214['length']-0x1;_0x2ee155>0x0;_0x2ee155--){const _0x170d8f=_0x3dc214[_0x2ee155];_0x2ee155!==this['items'][_0x4571('0x13')](_0x170d8f)&&(this[_0x4571('0x2')]['remove'](_0x170d8f),this[_0x4571('0x2')][_0x4571('0x8')](_0x170d8f,_0x2ee155));}}['m'](_0x2569fe){let _0x5eed12=0x0;for(const _0x5e6fd2 of this['items']){const _0x424232=this[_0x4571('0x27')](_0x5e6fd2[_0x4571('0x1d')]);if(c(_0x2569fe,new _0x505dc8(_0x424232))<0x0)return _0x5eed12;_0x5eed12++;}return Math[_0x4571('0x25')](0x0,_0x5eed12);}}function c(_0x11b7b5,_0x573c54){const _0x6e31e0=_0x11b7b5[_0x4571('0x24')]-_0x573c54[_0x4571('0x24')];return 0x0==_0x6e31e0?_0x11b7b5[_0x4571('0x11')]-_0x573c54[_0x4571('0x11')]:_0x6e31e0;}